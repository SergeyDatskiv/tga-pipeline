FROM registry.jetbrains.team/p/automatically-generating-unit-tests/sdatskiv-tga-pipeline/tga-pipeline:base-0.0.2
LABEL maintainer="Sergey Datskiv <sergey.datskiv@jetbrains.com>"
LABEL version="0.0.0"
LABEL description="Docker image similar to abdullin/tga-pipeline:tools, however with some changes needed for my experimental setup. E.g. I build on top of my base image and include test replication package from Test Wars paper to access already generated LLM tests."

# run tool
USER root
WORKDIR /tga-pipeline
RUN ./gradlew :tga-tool:build

# give access to all users
RUN chmod a+r -R /tga-pipeline
RUN chmod a+w -R /tga-pipeline

ENTRYPOINT ["java", "-jar", "/tga-pipeline/tga-tool/build/libs/tga-tool.jar"]